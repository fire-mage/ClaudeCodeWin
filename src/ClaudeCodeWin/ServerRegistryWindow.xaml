<Window x:Class="ClaudeCodeWin.ServerRegistryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SSH &amp; Server Registry"
        Width="700" Height="520"
        MinWidth="500" MinHeight="400"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundBrush}">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- SSH Key section -->
        <TextBlock Grid.Row="0" Text="Claude's SSH Key" FontSize="16" FontWeight="Bold"
                   Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,8"/>

        <Grid Grid.Row="1" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox Grid.Column="0" x:Name="SshKeyPathBox"
                     Style="{StaticResource InputTextBox}"
                     VerticalAlignment="Center"
                     IsReadOnly="True"/>
            <Button Grid.Column="1" Content="Browse..."
                    Click="BrowseSshKey_Click"
                    Padding="16,6" Margin="8,0,0,0"
                    Background="{StaticResource SurfaceLightBrush}"
                    Foreground="{StaticResource TextBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    Cursor="Hand"/>
            <Button Grid.Column="2" Content="Clear"
                    Click="ClearSshKey_Click"
                    Padding="16,6" Margin="8,0,0,0"
                    Background="{StaticResource SurfaceBrush}"
                    Foreground="{StaticResource TextSecondaryBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    Cursor="Hand"/>
        </Grid>

        <!-- SSH Master Password -->
        <TextBlock Grid.Row="2" Text="SSH Master Password" FontSize="14" FontWeight="SemiBold"
                   Foreground="{StaticResource TextBrush}" Margin="0,0,0,6"/>

        <Grid Grid.Row="3" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <PasswordBox Grid.Column="0" x:Name="SshMasterPasswordBox"
                         Background="{StaticResource SurfaceBrush}"
                         Foreground="{StaticResource TextBrush}"
                         BorderBrush="{StaticResource BorderBrush}"
                         BorderThickness="1"
                         Padding="10,8"
                         FontSize="14"
                         FontFamily="Cascadia Code,Consolas,Courier New"
                         VerticalAlignment="Center"/>
            <Button Grid.Column="1" Content="Clear"
                    Click="ClearSshPassword_Click"
                    Padding="16,6" Margin="8,0,0,0"
                    Background="{StaticResource SurfaceBrush}"
                    Foreground="{StaticResource TextSecondaryBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    Cursor="Hand"/>
        </Grid>

        <!-- Servers header -->
        <Grid Grid.Row="4" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="Known Servers" FontSize="16" FontWeight="Bold"
                       Foreground="{StaticResource PrimaryBrush}" VerticalAlignment="Center"/>
            <Button Grid.Column="1" Content="+ Add" Click="AddServer_Click"
                    Padding="16,6" Margin="0,0,8,0"
                    Style="{StaticResource PrimaryButton}"/>
            <Button Grid.Column="2" Content="Test" x:Name="TestButton"
                    Click="TestServer_Click"
                    Padding="16,6" IsEnabled="False" Margin="0,0,8,0"
                    Foreground="{StaticResource PrimaryBrush}"
                    Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource PrimaryBrush}"
                    Cursor="Hand"/>
            <Button Grid.Column="3" Content="Remove" x:Name="RemoveButton"
                    Click="RemoveServer_Click"
                    Padding="16,6" IsEnabled="False"
                    Foreground="{StaticResource ErrorBrush}"
                    Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource ErrorBrush}"
                    Cursor="Hand"/>
        </Grid>

        <!-- Server list -->
        <ListView Grid.Row="5" x:Name="ServerList"
                  Background="{StaticResource SurfaceBrush}"
                  BorderBrush="{StaticResource BorderBrush}"
                  BorderThickness="1"
                  Foreground="{StaticResource TextBrush}"
                  SelectionChanged="ServerList_SelectionChanged"
                  MouseDoubleClick="ServerList_MouseDoubleClick"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                    <Setter Property="Padding" Value="8,6"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListViewItem">
                                <Border x:Name="Bd" Background="Transparent"
                                        Padding="{TemplateBinding Padding}"
                                        BorderBrush="{StaticResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <ContentPresenter/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Bd" Property="Background"
                                                Value="{StaticResource MenuHighlightBrush}"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background"
                                                Value="{StaticResource SurfaceLightBrush}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <TextBlock Text="{Binding Name}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextBrush}"/>
                            <TextBlock Text="{Binding ConnectionString}" FontSize="12"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="12,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Grid.Row="1" Text="{Binding Details}" FontSize="11"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,2,0,0"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Bottom buttons -->
        <StackPanel Grid.Row="6" Orientation="Horizontal"
                    HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Save" Click="SaveButton_Click"
                    Style="{StaticResource PrimaryButton}"
                    Padding="24,6" Margin="0,0,8,0"/>
            <Button Content="Cancel" Click="CancelButton_Click"
                    Padding="24,6"
                    Background="{StaticResource SurfaceBrush}"
                    Foreground="{StaticResource TextBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    Cursor="Hand"/>
        </StackPanel>
    </Grid>
</Window>
